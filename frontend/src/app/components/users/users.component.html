<div class="h-100 p-4">
  <!-- Check if userStats is not empty -->
  @if (userStats.length > 0) {
  <h1>Users</h1>
  <p>Here you can find the list of users and their statistics.</p>
  <input
    type="text"
    placeholder="Search by username or email"
    class="form-control w-50 mb-3" 
    [(ngModel)]="searchTerm"
  />

  <div class="table-wrapper">
    <table>
      <thead>
        <tr>
          <th>Username</th>
          <th>Email</th>
          <th>Total Uploads</th>
          <th>Average Duration</th>
          <th>Last Detection Status</th>
          <th>Last Upload Date</th>
          <th>Activation</th>
          <th>Delete</th>
        </tr>
      </thead>
      <tbody>
        @for (user of filteredUsers; track user.userId) {
        <tr>
          <td>{{ user.user.username }}</td>
          <td>{{ user.user.email }}</td>
          <td>{{ user.totalUploads }}</td>
          <td>{{ user.averageDuration  }} mins</td>
          <td>{{ user.lastDetectionStatus }}</td>
          <td>{{ user.lastUploadDate | date : "short" }}</td>

          <!-- Conditional: isActive -->
          @if (user.user.isActive) {
          <td>
            <button
              class="action-btn deactivate-btn"
              (click)="deactivateUser(user.userId)"
            >
              Deactivate
            </button>
          </td>
          } @else {
          <td>
            <button class="action-btn activate-btn" (click)="activateUser(user.userId)">
              Activate
            </button>
          </td>
          }

          <!-- Always show Delete -->
          <td>
            <button class="action-btn delete-btn" (click)="deleteUser(user.userId)">
              Delete <i class="fas fa-trash-alt delete-icon"></i>
            </button>
          </td>
        </tr>
        }
      </tbody>
    </table>
  </div>
  } @else {
  <div class="d-flex justify-content-center align-items-center">
    <p class="w-100 alert alert-danger">
      No stats found.<i class="fas fa-exclamation-circle text-danger"></i>
    </p>
  </div>
  }
</div>
